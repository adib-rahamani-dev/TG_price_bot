<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #f7f9fc; font-family: 'Segoe UI', sans-serif; }
        .card { margin-top: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .toggle-section { margin: 20px 0; padding: 15px; background: #f9f9f9; border-radius: 8px; border-left: 4px solid #007bff; }
        .form-switch { font-size: 18px; }
        .status-badge { font-size: 14px; margin-left: 10px; }
        .badge-enabled { background-color: #28a745; }
        .badge-disabled { background-color: #dc3545; }
        .setting-description { color: #666; font-size: 14px; margin-top: 5px; }
        .nav-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
    </style>
</head>
<body>
<div class="container mt-5">
    <div class="nav-header">
        <h1>âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³ÛŒØ³ØªÙ…</h1>
        <p>Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ…Ø§Ù… ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¨Ø§Øª Ùˆ Ø³Ø±ÙˆØ±</p>
    </div>

    <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ø§Ù†ÙÛŒÚ¯ -->
    <div class="card">
        <div class="card-header bg-primary text-white">
            <h5 class="mb-0">ğŸ“‹ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ø§Ù†ÙÛŒÚ¯</h5>
        </div>
        <div class="card-body">
            <div class="toggle-section">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6>ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ/ØºÛŒØ±ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù†ÙÛŒÚ¯</h6>
                        <p class="setting-description">Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø§Ù†ÙÛŒÚ¯ Ø¨Ø§ÛŒØ¯ Ø¨ØªÙˆØ§Ù†Ù†Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø§Ø±Ø³Ø§Ù„ Ú©Ù†Ù†Ø¯</p>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="configToggle" checked>
                        <label class="form-check-label" for="configToggle"></label>
                    </div>
                </div>
                <div class="mt-2">
                    <span class="badge badge-enabled status-badge" id="configStatus">ÙØ¹Ø§Ù„</span>
                </div>
            </div>

            <div class="toggle-section">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6>ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ/ØºÛŒØ±ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ØµÙØ­Ù‡ ÙˆØ¨</h6>
                        <p class="setting-description">ØµÙØ­Ù‡ Ø«Ø¨Øª Ú©Ø§Ù†ÙÛŒÚ¯ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ù†Ù‡Ø§</p>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="webPageToggle" checked>
                        <label class="form-check-label" for="webPageToggle"></label>
                    </div>
                </div>
                <div class="mt-2">
                    <span class="badge badge-enabled status-badge" id="webPageStatus">ÙØ¹Ø§Ù„</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ -->
    <div class="card">
        <div class="card-header bg-success text-white">
            <h5 class="mb-0">ğŸ’° ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§</h5>
        </div>
        <div class="card-body">
            <div class="toggle-section">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6>Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø±ÙˆØ²</h6>
                        <p class="setting-description">Ù†Ù…Ø§ÛŒØ´ Ø¢Ø®Ø±ÛŒÙ† Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØªÛŒ Ø§Ø² API</p>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="pricesToggle" checked>
                        <label class="form-check-label" for="pricesToggle"></label>
                    </div>
                </div>
                <div class="mt-2">
                    <span class="badge badge-enabled status-badge" id="pricesStatus">ÙØ¹Ø§Ù„</span>
                </div>
            </div>

            <div class="row mt-3">
                <div class="col-md-6">
                    <h6>Ø¨Ø§Ø²Ù‡â€ŒÛŒ ØªØ§Ø²Ù‡â€ŒØ³Ø§Ø²ÛŒ (Ø«Ø§Ù†ÛŒÙ‡):</h6>
                    <input type="number" id="refreshInterval" class="form-control" value="1800" min="60">
                    <small class="text-muted">Ø­Ø¯Ø§Ù‚Ù„ 60 Ø«Ø§Ù†ÛŒÙ‡</small>
                </div>
                <div class="col-md-6">
                    <h6>ØªØ¹Ø¯Ø§Ø¯ Ù†Ù…Ø§Ø¯â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„:</h6>
                    <div class="alert alert-info">
                        âœ“ IR_GOLD_18K<br>
                        âœ“ IR_COIN_EMAMI<br>
                        âœ“ USDT
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙÛŒØ¯Ø¨Ú© -->
    <div class="card">
        <div class="card-header bg-warning text-dark">
            <h5 class="mb-0">ğŸ’¬ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙÛŒØ¯Ø¨Ú©</h5>
        </div>
        <div class="card-body">
            <div class="toggle-section">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6>ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ/ØºÛŒØ±ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ ÙÛŒØ¯Ø¨Ú©</h6>
                        <p class="setting-description">Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¨ØªÙˆØ§Ù†Ù†Ø¯ ÙÛŒØ¯Ø¨Ú© Ø§Ø±Ø³Ø§Ù„ Ú©Ù†Ù†Ø¯</p>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="feedbackToggle" checked>
                        <label class="form-check-label" for="feedbackToggle"></label>
                    </div>
                </div>
                <div class="mt-2">
                    <span class="badge badge-enabled status-badge" id="feedbackStatus">ÙØ¹Ø§Ù„</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú†Ú© Ú©Ø§Ù†Ø§Ù„ -->
    <div class="card">
        <div class="card-header bg-info text-white">
            <h5 class="mb-0">ğŸ“¢ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú†Ú© Ú©Ø§Ù†Ø§Ù„</h5>
        </div>
        <div class="card-body">
            <div class="toggle-section">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h6>Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ø¶ÙˆÛŒØª Ø¯Ø± Ú©Ø§Ù†Ø§Ù„</h6>
                        <p class="setting-description">ÙÙ‚Ø· Ø§Ø¹Ø¶Ø§ÛŒ Ú©Ø§Ù†Ø§Ù„ Ø¨ØªÙˆØ§Ù†Ù†Ø¯ Ø§Ø² Ø¨Ø§Øª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ù†Ø¯</p>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="channelCheckToggle" checked>
                        <label class="form-check-label" for="channelCheckToggle"></label>
                    </div>
                </div>
                <div class="mt-2">
                    <span class="badge badge-enabled status-badge" id="channelCheckStatus">ÙØ¹Ø§Ù„</span>
                </div>
            </div>

            <div class="mt-3">
                <label class="form-label">Ù†Ø§Ù… Ú©Ø§Ù†Ø§Ù„:</label>
                <input type="text" id="channelName" class="form-control" value="@rmanrajaei" placeholder="@channel_name">
            </div>
        </div>
    </div>

    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ -->
    <div class="card">
        <div class="card-body">
            <button id="saveBtn" class="btn btn-primary btn-lg">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª</button>
            <button id="resetBtn" class="btn btn-outline-secondary btn-lg">ğŸ”„ Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ</button>
            <div id="message" class="mt-3"></div>
        </div>
    </div>

    <footer class="text-center text-muted mt-5 mb-5">
        <small>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª | Â© 2026</small>
    </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
    async function loadSettings() {
        try {
            const res = await fetch('/settings');
            const data = await res.json();
            
            document.getElementById('configToggle').checked = data.config_enabled !== false;
            document.getElementById('webPageToggle').checked = data.web_page_enabled !== false;
            document.getElementById('pricesToggle').checked = data.prices_enabled !== false;
            document.getElementById('feedbackToggle').checked = data.feedback_enabled !== false;
            document.getElementById('channelCheckToggle').checked = data.channel_check_enabled !== false;
            
            if (data.refresh_interval) {
                document.getElementById('refreshInterval').value = data.refresh_interval;
            }
            if (data.channel_name) {
                document.getElementById('channelName').value = data.channel_name;
            }
            
            updateAllStatus();
        } catch (e) {
            console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª:', e);
        }
    }

    // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù†Ù…Ø§ÛŒØ´
    function updateStatus(elementId, statusId) {
        const isChecked = document.getElementById(elementId).checked;
        const statusEl = document.getElementById(statusId);
        if (isChecked) {
            statusEl.textContent = 'âœ“ ÙØ¹Ø§Ù„';
            statusEl.className = 'badge badge-enabled status-badge';
        } else {
            statusEl.textContent = 'âœ• ØºÛŒØ±ÙØ¹Ø§Ù„';
            statusEl.className = 'badge badge-disabled status-badge';
        }
    }

    function updateAllStatus() {
        updateStatus('configToggle', 'configStatus');
        updateStatus('webPageToggle', 'webPageStatus');
        updateStatus('pricesToggle', 'pricesStatus');
        updateStatus('feedbackToggle', 'feedbackStatus');
        updateStatus('channelCheckToggle', 'channelCheckStatus');
    }

    // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ ØªØºÛŒÛŒØ±
    document.getElementById('configToggle').addEventListener('change', () => updateStatus('configToggle', 'configStatus'));
    document.getElementById('webPageToggle').addEventListener('change', () => updateStatus('webPageToggle', 'webPageStatus'));
    document.getElementById('pricesToggle').addEventListener('change', () => updateStatus('pricesToggle', 'pricesStatus'));
    document.getElementById('feedbackToggle').addEventListener('change', () => updateStatus('feedbackToggle', 'feedbackStatus'));
    document.getElementById('channelCheckToggle').addEventListener('change', () => updateStatus('channelCheckToggle', 'channelCheckStatus'));

    // Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
    document.getElementById('saveBtn').addEventListener('click', async () => {
        const settings = {
            config_enabled: document.getElementById('configToggle').checked,
            web_page_enabled: document.getElementById('webPageToggle').checked,
            prices_enabled: document.getElementById('pricesToggle').checked,
            feedback_enabled: document.getElementById('feedbackToggle').checked,
            channel_check_enabled: document.getElementById('channelCheckToggle').checked,
            refresh_interval: parseInt(document.getElementById('refreshInterval').value),
            channel_name: document.getElementById('channelName').value
        };

        try {
            const res = await fetch('/settings', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(settings)
            });
            const data = await res.json();
            
            const msgEl = document.getElementById('message');
            if (data.ok) {
                msgEl.innerHTML = '<div class="alert alert-success">âœ… ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯</div>';
                setTimeout(() => msgEl.innerHTML = '', 3000);
            } else {
                msgEl.innerHTML = '<div class="alert alert-danger">âŒ Ø®Ø·Ø§: ' + (data.message || 'Ù†Ø§Ù…Ø´Ø®Øµ') + '</div>';
            }
        } catch (e) {
            document.getElementById('message').innerHTML = '<div class="alert alert-danger">âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø·: ' + e.message + '</div>';
        }
    });

    // Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ
    document.getElementById('resetBtn').addEventListener('click', loadSettings);

    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
    loadSettings();
</script>
</body>
</html>
